---
id: ba-651a
status: open
deps: [ba-a8ab, ba-3440]
links: []
created: 2026-01-29T18:14:33Z
type: task
priority: 2
assignee: vot3k
parent: ba-0cdb
---
# Update install script to optionally deploy vmm-api

## Objective
Update scripts/install.sh and create scripts/install-api.sh to support deploying the API daemon alongside the CLI.

## Location
- Modify: scripts/install.sh (add --with-api flag)
- New file: scripts/install-api.sh (standalone API installer)

## Implementation Details

### Modified install.sh
Add optional --with-api flag:
1. Install vmm binary (existing behavior)
2. If --with-api: also install vmm-api binary
3. If --with-api: install systemd service file
4. If --with-api: create /etc/vmm/tls/ directory
5. Print post-install instructions for certificate setup

### Standalone install-api.sh
For hosts that already have vmm installed:
1. Check running as root
2. Download or copy vmm-api binary to /usr/local/bin/
3. Create /etc/vmm/ and /etc/vmm/tls/ directories
4. Copy vmm-api.service to /etc/systemd/system/
5. Run systemctl daemon-reload
6. Print instructions for:
   - Certificate placement
   - systemctl enable vmm-api
   - systemctl start vmm-api
   - Verifying with curl

### Idempotency
Both scripts must be safe to run multiple times. Overwrite binaries, skip directory creation if exists.

## Acceptance Criteria
- install.sh --with-api installs both vmm and vmm-api
- install-api.sh works standalone for existing vmm installations
- Both scripts are idempotent
- Clear post-install instructions printed

## Acceptance Criteria

install.sh --with-api works; install-api.sh standalone works; both idempotent

